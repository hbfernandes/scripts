#!/usr/bin/env groovy

// copy all jars in a project to a destination, as long as they are directly under a "target" folder

import java.nio.file.Files
import static groovy.io.FileType.FILES

File search = new File(args[0])
File output = new File(args[1])

List parents = ['target']
List extensions = ['.jar', '.zip', '.kar']
List blacklist = ['-sources.jar']

search.eachFileRecurse(FILES) { file ->
  if( extensions.any{ file.name.endsWith(it) } &&
      !blacklist.any{ file.name.endsWith(it) } &&
      file.parentFile.name in parents) {
    Files.copy(file.toPath(), new File(output, file.name).toPath())
  }
}